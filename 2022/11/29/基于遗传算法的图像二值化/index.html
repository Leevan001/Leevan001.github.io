<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>基于遗传算法的图像二值化 | 早早起床，拥抱太阳</title><meta name="author" content="如风"><meta name="copyright" content="如风"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="[toc] 基于遗传算法的图像二值化 本实验采用遗传算法和大津算法确定图像二值化的最佳阈值，从而对图像进行二值化分割 (重庆大学2020级软件学院人工智能导论第一次实验) 大津算法(OTSU) 最大类间方差法是1979年由日本学者大津提出的，是一种自适应阈值确定的方法，又叫大津法，简称OTSU，是一种基于全局的二值化算法. 它是根据图像的灰度特性,将图像分为前景和背景两个部分。当取最佳阈值时，两部">
<meta property="og:type" content="article">
<meta property="og:title" content="基于遗传算法的图像二值化">
<meta property="og:url" content="https://blog.liyifan001.top/2022/11/29/%E5%9F%BA%E4%BA%8E%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%E7%9A%84%E5%9B%BE%E5%83%8F%E4%BA%8C%E5%80%BC%E5%8C%96/index.html">
<meta property="og:site_name" content="早早起床，拥抱太阳">
<meta property="og:description" content="[toc] 基于遗传算法的图像二值化 本实验采用遗传算法和大津算法确定图像二值化的最佳阈值，从而对图像进行二值化分割 (重庆大学2020级软件学院人工智能导论第一次实验) 大津算法(OTSU) 最大类间方差法是1979年由日本学者大津提出的，是一种自适应阈值确定的方法，又叫大津法，简称OTSU，是一种基于全局的二值化算法. 它是根据图像的灰度特性,将图像分为前景和背景两个部分。当取最佳阈值时，两部">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/1668325964310EA2896391D75964E20FD6F6F2657923C.png">
<meta property="article:published_time" content="2022-11-29T11:50:26.000Z">
<meta property="article:modified_time" content="2023-03-23T03:28:12.555Z">
<meta property="article:author" content="如风">
<meta property="article:tag" content="遗传算法">
<meta property="article:tag" content="大津算法">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/1668325964310EA2896391D75964E20FD6F6F2657923C.png"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="canonical" href="https://blog.liyifan001.top/2022/11/29/%E5%9F%BA%E4%BA%8E%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%E7%9A%84%E5%9B%BE%E5%83%8F%E4%BA%8C%E5%80%BC%E5%8C%96/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 如风","link":"链接: ","source":"来源: 早早起床，拥抱太阳","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '基于遗传算法的图像二值化',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-23 11:28:12'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/1668273103133D8802D069515E0A42BC91FDE752B8A5C.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/1668325964310EA2896391D75964E20FD6F6F2657923C.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">早早起床，拥抱太阳</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">基于遗传算法的图像二值化</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-11-29T11:50:26.000Z" title="发表于 2022-11-29 19:50:26">2022-11-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-23T03:28:12.555Z" title="更新于 2023-03-23 11:28:12">2023-03-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/">Python</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/AI/">AI</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>7分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="基于遗传算法的图像二值化"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>[toc]</p>
<h1>基于遗传算法的图像二值化</h1>
<p>本实验采用遗传算法和大津算法确定图像二值化的最佳阈值，从而对图像进行二值化分割</p>
<p>(重庆大学2020级软件学院人工智能导论第一次实验)</p>
<h2 id="大津算法-otsu">大津算法(OTSU)</h2>
<p>最大类间方差法是1979年由日本学者大津提出的，<strong>是一种自适应阈值确定的方法</strong>，又叫大津法，简称OTSU，是一种基于<strong>全局的二值化算法</strong>.</p>
<p>它是<strong>根据</strong>图像的<strong>灰度特性</strong>,将图像分为<font color='orange'>前景</font>和<font color='orange'>背景</font>两个部分。当取最佳阈值时，两部分之间的差别应该是最大的，在OTSU算法中所采用的衡量差别的标准就是较为常见的最大类间方差。<font color='red'>前景和背景之间的类间方差如果越大，就说明构成图像的两个部分之间的差别越大</font>，当部分目标被错分为背景或部分背景被错分为目标，都会导致两部分差别变小，当所取阈值的分割使类间方差最大时就意味着错分概率最小</p>
<img src="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/16686955946871668695594146.png" style="zoom:80%;" />
<h2 id="实验思路">实验思路</h2>
<p><img src="C:%5CUsers%5C12498%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221117223340453.png" alt="image-20221117223340453"></p>
<h2 id="q-a">Q&amp;A</h2>
<p>1.如何建立灰度图和染色体的联系：</p>
<p>灰度图中，每个像素点的灰度值从0到255，二进制形式是8比特位，将八个比特位看成一个染色体，每一个比特位就是一个基因点。</p>
<p>2.如何考虑选择下一代种群：</p>
<p>首先先把种群中的每一个个体计算适应度，借助OTSU算法，计算得出个体适应度，适应度的大小即可表示个体的优劣程度。但不能只选出色的个体，有些不好的个体可能会产生优质的下一代个体，因此在选择的时候，考虑首先选择前百分比a的优秀个体，剩下的个体中，随机选取比例b的个体幸存，其余淘汰。</p>
<p>3.如何考虑变异：</p>
<p>考虑到真实的环境中变异的可能性比较小，所以设定了一个变异概</p>
<p>率来控制变异的可能性。</p>
<h2 id="最终代码：">最终代码：</h2>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">imshow</span>(<span class="params">img,mode=<span class="number">0</span></span>):<span class="comment">#0表示灰度图，1表示彩色图</span></span><br><span class="line">    plt.figure(<span class="string">&quot;Image&quot;</span>)  <span class="comment"># 图像窗口名称</span></span><br><span class="line">    <span class="keyword">if</span> mode==<span class="number">0</span>:</span><br><span class="line">        plt.imshow(img,cmap=<span class="string">&quot;gray&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        plt.imshow(img)</span><br><span class="line">    plt.axis(<span class="string">&#x27;on&#x27;</span>)  <span class="comment"># 关掉坐标轴为 off</span></span><br><span class="line">    plt.title(<span class="string">&#x27;image&#x27;</span>)  <span class="comment"># 图像题目</span></span><br><span class="line">    <span class="comment"># 必须有这个，要不然无法显示</span></span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">filename=<span class="string">&quot;./img02.jpg&quot;</span></span><br><span class="line">img = Image.<span class="built_in">open</span>(filename)</span><br><span class="line"><span class="built_in">print</span>(img.mode,img.size,img.<span class="built_in">format</span>)</span><br><span class="line"><span class="comment">#img = img.convert(&#x27;L&#x27;) # translate to  gray map   L = R * 299/1000 + G * 587/1000+ B * 114/1000</span></span><br><span class="line"><span class="comment">#img.show()</span></span><br><span class="line"><span class="comment">#print(img)</span></span><br></pre></td></tr></table></figure>
<pre><code>RGB (1200, 1200) JPEG
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">array = np.array(img)</span><br><span class="line">imshow(array,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<img src="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/16686949156891668694915439.png" style="zoom:33%;" align='left' />
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#手写convert(&#x27;L&#x27;)， L = R * 299/1000 + G * 587/1000+ B * 114/1000RGB转灰度图</span></span><br><span class="line">h,w,_=array.shape</span><br><span class="line">grayarray=np.zeros((h,w),dtype=<span class="string">&#x27;int32&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">        grayarray[i][j]=<span class="built_in">round</span>(array[i][j][<span class="number">0</span>]*<span class="number">0.299</span>+array[i][j][<span class="number">1</span>]*<span class="number">0.587</span>+array[i][j][<span class="number">2</span>]*<span class="number">0.114</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imshow(grayarray,<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<img src="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/16686949836891668694983156.png" style="zoom:33%;" align='left'/>
<p>​</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ostu</span>(<span class="params">image,threshold</span>):</span><br><span class="line">    sumT=np.<span class="built_in">sum</span>(image)<span class="comment">#求灰度值总和</span></span><br><span class="line">    count=image.size<span class="comment">#求图片的大小</span></span><br><span class="line">    judge=image&lt;threshold</span><br><span class="line">    w0=np.<span class="built_in">sum</span>(judge);<span class="comment">#小于阈值的个数</span></span><br><span class="line">    sum0=np.<span class="built_in">sum</span>(judge*image);<span class="comment">#求小于阈值的数值之和</span></span><br><span class="line">    w1=count-w0</span><br><span class="line">    <span class="keyword">if</span> w0==<span class="number">0</span>|w1==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    mean0=<span class="number">1.0</span>*sum0/w0</span><br><span class="line">    mean1=<span class="number">1.0</span>*(sumT-sum0)/w1</span><br><span class="line">    w0=<span class="number">1.0</span>*w0/count</span><br><span class="line">    w1=<span class="number">1.0</span>*w1/count</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1.0</span>*w0*w1*(mean0-mean1)*(mean0-mean1)</span><br><span class="line"><span class="comment">#print(ostu(grayarray,230))</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">GA</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,image,N=<span class="number">10</span>,retain_rate=<span class="number">0.2</span>,random_select_rate = <span class="number">0.5</span>,mutation_rate = <span class="number">0.1</span></span>):</span><br><span class="line">        self.image=image</span><br><span class="line">        self.N=N<span class="comment">#种群的个体个数</span></span><br><span class="line">        self.population=np.random.randint(<span class="number">0</span>,<span class="number">256</span>,self.N)<span class="comment">#初始化</span></span><br><span class="line">        self.retain_rate=retain_rate;<span class="comment">#保留率，保留优秀的基因</span></span><br><span class="line">        self.random_select_rate = random_select_rate<span class="comment">#选择率</span></span><br><span class="line">        self.mutation_rate = mutation_rate<span class="comment">#变异率</span></span><br><span class="line">        self.length=<span class="number">8</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fitness</span>(<span class="params">self,threshold</span>):</span><br><span class="line">        <span class="keyword">return</span> ostu(self.image,threshold)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">selection</span>(<span class="params">self</span>):<span class="comment">#进行选择</span></span><br><span class="line">        graded=[(self.fitness(threshold),threshold) <span class="keyword">for</span> threshold <span class="keyword">in</span> self.population]</span><br><span class="line">        graded=[x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">sorted</span>(graded,reverse=<span class="literal">True</span>)]<span class="comment">#按适应能力从小到大排序</span></span><br><span class="line">        <span class="comment">#选出适应性强的染色体</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;阈值：&quot;</span>,graded[<span class="number">0</span>],<span class="string">&quot;适应度&quot;</span>,self.fitness(graded[<span class="number">0</span>]))</span><br><span class="line">        retain_length=<span class="built_in">round</span>(<span class="built_in">len</span>(graded)*self.retain_rate)+<span class="number">1</span>;</span><br><span class="line">        parents=graded[:retain_length]</span><br><span class="line">        <span class="comment">#选出适应性不强，但是幸存的染色体</span></span><br><span class="line">        <span class="keyword">for</span> chromosome <span class="keyword">in</span> graded[retain_length:]:</span><br><span class="line">            <span class="keyword">if</span> np.random.random()&lt;self.random_select_rate:</span><br><span class="line">                parents.append(chromosome)</span><br><span class="line">        <span class="keyword">return</span> parents</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">crossover</span>(<span class="params">self,parents</span>):<span class="comment">#交叉操作</span></span><br><span class="line">        children=[]</span><br><span class="line">        needelse=self.N-<span class="built_in">len</span>(parents)</span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(children)&lt;needelse:</span><br><span class="line">            male,female=np.random.choice(<span class="built_in">len</span>(parents)-<span class="number">1</span>, <span class="number">2</span>, replace=<span class="literal">False</span>)</span><br><span class="line">            <span class="comment"># 随机选取交叉点</span></span><br><span class="line">            cross_pos=np.random.randint(<span class="number">0</span>, self.length)</span><br><span class="line">            <span class="comment">#生成掩码</span></span><br><span class="line">            mask=<span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cross_pos):</span><br><span class="line">                mask |=(<span class="number">1</span>&lt;&lt;i)</span><br><span class="line">            male=parents[male]</span><br><span class="line">            female=parents[female]</span><br><span class="line">            child=((male&amp;mask))|(female&amp;~mask)</span><br><span class="line">            children.append(child)</span><br><span class="line">        self.population=parents+children</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mutation</span>(<span class="params">self,rate</span>):<span class="comment">#变异</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.N):</span><br><span class="line">            <span class="keyword">if</span> np.random.random()&lt;rate:</span><br><span class="line">                j=np.random.randint(<span class="number">0</span>,self.length-<span class="number">1</span>)</span><br><span class="line">                self.population[i]^=(<span class="number">1</span>&lt;&lt;j)<span class="comment">#随机取以一位异或</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">evolve</span>(<span class="params">self</span>):<span class="comment">#进化</span></span><br><span class="line">        parents=self.selection()</span><br><span class="line">        self.crossover(parents)</span><br><span class="line">        self.mutation(self.mutation_rate)</span><br><span class="line">                </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">result</span>(<span class="params">self</span>):</span><br><span class="line">        graded = [(self.fitness(chromosome), chromosome) <span class="keyword">for</span> chromosome <span class="keyword">in</span> self.population]</span><br><span class="line">        graded = [x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">sorted</span>(graded, reverse=<span class="literal">True</span>)]</span><br><span class="line">        <span class="keyword">return</span> graded[<span class="number">0</span>]</span><br><span class="line">            </span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ga=GA(grayarray)</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    ga.evolve()</span><br><span class="line"><span class="comment">#     print(&quot;res&quot;,res,&quot;fitness&quot;,fitness)</span></span><br><span class="line"><span class="comment">#     print(&quot;-&quot;*30)</span></span><br><span class="line">x,y=ga.result()</span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<pre><code>D:\anaconda3\envs\pytorch\lib\site-packages\ipykernel_launcher.py:10: RuntimeWarning: invalid value encountered in double_scalars
  # Remove the CWD from sys.path while we load stuff.


阈值： 112 适应度 2614.823209590889
阈值： 112 适应度 2614.823209590889
阈值： 112 适应度 2614.823209590889
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949


D:\anaconda3\envs\pytorch\lib\site-packages\ipykernel_launcher.py:11: RuntimeWarning: invalid value encountered in double_scalars
  # This is added back by InteractiveShellApp.init_path()


阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
阈值： 106 适应度 2621.80194615949
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">maxtmp=<span class="number">0</span></span><br><span class="line">maxindex=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    tmp=ostu(grayarray,i)</span><br><span class="line">    <span class="keyword">if</span>(tmp&gt;maxtmp):</span><br><span class="line">        maxtmp=tmp</span><br><span class="line">        maxindex=i</span><br><span class="line"><span class="built_in">print</span>(maxindex,maxtmp)</span><br></pre></td></tr></table></figure>
<pre><code>D:\anaconda3\envs\pytorch\lib\site-packages\ipykernel_launcher.py:10: RuntimeWarning: invalid value encountered in double_scalars
  # Remove the CWD from sys.path while we load stuff.


106 2621.80194615949


D:\anaconda3\envs\pytorch\lib\site-packages\ipykernel_launcher.py:11: RuntimeWarning: invalid value encountered in double_scalars
  # This is added back by InteractiveShellApp.init_path()
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">intensity_array = np.where(grayarray&lt;y, <span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line"><span class="built_in">print</span>(intensity_array)</span><br></pre></td></tr></table></figure>
<pre><code>[[  0   0   0 ... 255 255 255]
 [  0   0   0 ... 255 255 255]
 [  0   0   0 ... 255 255 255]
 ...
 [  0   0   0 ...   0   0   0]
 [  0   0   0 ...   0   0   0]
 [  0   0   0 ...   0   0   0]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imshow(intensity_array)</span><br></pre></td></tr></table></figure>
<img src="C:\Users\12498\AppData\Roaming\Typora\typora-user-images\image-20221117222334851.png" alt="image-20221117222334851" style="zoom:33%;" />
<h2 id="实验反思">实验反思</h2>
<p>其实可以暴力枚举，或许效果更好且更快，但因为要求是用遗传算法，所以还是用到遗传算法。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://github.com/Leevan001">如风</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.liyifan001.top/2022/11/29/%E5%9F%BA%E4%BA%8E%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%E7%9A%84%E5%9B%BE%E5%83%8F%E4%BA%8C%E5%80%BC%E5%8C%96/">https://blog.liyifan001.top/2022/11/29/%E5%9F%BA%E4%BA%8E%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%E7%9A%84%E5%9B%BE%E5%83%8F%E4%BA%8C%E5%80%BC%E5%8C%96/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.liyifan001.top" target="_blank">早早起床，拥抱太阳</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95/">遗传算法</a><a class="post-meta__tags" href="/tags/%E5%A4%A7%E6%B4%A5%E7%AE%97%E6%B3%95/">大津算法</a></div><div class="post_share"><div class="social-share" data-image="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/1668325964310EA2896391D75964E20FD6F6F2657923C.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/1668273103133D8802D069515E0A42BC91FDE752B8A5C.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">如风</div><div class="author-info__description">热爱睡觉的小笨蛋一枚吖~</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Leevan001"><i></i><span>🛴前往小家...</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Leevan001" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:liyifancqu@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">基于遗传算法的图像二值化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A7%E6%B4%A5%E7%AE%97%E6%B3%95-otsu"><span class="toc-number">1.1.</span> <span class="toc-text">大津算法(OTSU)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%80%9D%E8%B7%AF"><span class="toc-number">1.2.</span> <span class="toc-text">实验思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#q-a"><span class="toc-number">1.3.</span> <span class="toc-text">Q&amp;A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E7%BB%88%E4%BB%A3%E7%A0%81%EF%BC%9A"><span class="toc-number">1.4.</span> <span class="toc-text">最终代码：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%8F%8D%E6%80%9D"><span class="toc-number">1.5.</span> <span class="toc-text">实验反思</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/06/03/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="数据库"><img src="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/1668274206122R-C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库"/></a><div class="content"><a class="title" href="/2023/06/03/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="数据库">数据库</a><time datetime="2023-06-03T12:11:46.000Z" title="发表于 2023-06-03 20:11:46">2023-06-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/03/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%A4%A7%E4%BD%9C%E4%B8%9A/" title="信息安全大作业"><img src="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/16683257273091668325726539.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="信息安全大作业"/></a><div class="content"><a class="title" href="/2023/06/03/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%A4%A7%E4%BD%9C%E4%B8%9A/" title="信息安全大作业">信息安全大作业</a><time datetime="2023-06-03T10:38:01.000Z" title="发表于 2023-06-03 18:38:01">2023-06-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/03/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" title="数字图像处理"><img src="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/1668325964310EA2896391D75964E20FD6F6F2657923C.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数字图像处理"/></a><div class="content"><a class="title" href="/2023/06/03/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" title="数字图像处理">数字图像处理</a><time datetime="2023-06-03T09:09:10.000Z" title="发表于 2023-06-03 17:09:10">2023-06-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/01/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统"><img src="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/1668274206122R-C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统"/></a><div class="content"><a class="title" href="/2023/06/01/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统">操作系统</a><time datetime="2023-06-01T13:54:29.000Z" title="发表于 2023-06-01 21:54:29">2023-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/06/%E8%BD%AF%E4%BB%B6%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%EF%BC%88%E4%B8%8B%EF%BC%89/" title="软件项目管理（下）"><img src="https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/1668325964310EA2896391D75964E20FD6F6F2657923C.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="软件项目管理（下）"/></a><div class="content"><a class="title" href="/2023/05/06/%E8%BD%AF%E4%BB%B6%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%EF%BC%88%E4%B8%8B%EF%BC%89/" title="软件项目管理（下）">软件项目管理（下）</a><time datetime="2023-05-06T07:27:20.000Z" title="发表于 2023-05-06 15:27:20">2023-05-06</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://fastly.jsdelivr.net/gh/Leevan001/pictureBed@main/utools/16683306913121668330690512.png')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By 如风</div><div class="footer_custom_text">广阔天地，大有作为</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>